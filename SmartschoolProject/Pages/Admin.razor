@page "/admin"
@inject NavigationManager navigationManager

<MatAccordion>
    <MatExpansionPanel>
        <MatExpansionPanelSummary>
            <MatExpansionPanelHeader>Bekijk alle winkels</MatExpansionPanelHeader>
        </MatExpansionPanelSummary>
        <MatExpansionPanelDetails>
            <div class="mat-layout-grid">
                <div class="mat-layout-grid-inner">
                    @foreach (WinkelDomain.Winkel winkel in winkels)
                    {
                        <div class="mat-layout-grid-cell mat-layout-grid-cell-span-2">
                            @winkel.winkelnr
                        </div>
                        <div class="mat-layout-grid-cell mat-layout-grid-cell-span-2">
                            @winkel.naam
                        </div>
                        <div class="mat-layout-grid-cell mat-layout-grid-cell-span-2">
                            @winkel.beheerder
                        </div>
                        <div class="mat-layout-grid-cell mat-layout-grid-cell-span-2">
                            @winkel.actief
                        </div>
                        <div class="mat-layout-grid-cell mat-layout-grid-cell-span-4">
                            <MatButton Type="submit" @key="winkel" OnClick="@(() => VerwijderWinkel(winkel))" Raised="true">Verwijder</MatButton>
                        </div>
                    }
                </div>
            </div>
        </MatExpansionPanelDetails>
    </MatExpansionPanel>
    <MatExpansionPanel>
        <MatExpansionPanelSummary>
            <MatExpansionPanelHeader>Bekijk alle winkelverzoeken</MatExpansionPanelHeader>
        </MatExpansionPanelSummary>
        <MatExpansionPanelDetails>

        </MatExpansionPanelDetails>
    </MatExpansionPanel>
    <MatExpansionPanel>
        <MatExpansionPanelSummary>
            <MatExpansionPanelHeader>Bekijk lokalen</MatExpansionPanelHeader>
            <MatExpansionPanelSubHeader>
                <MatButton Label="Voeg lokaal toe" OnClick="@maakLokaalAan" />
            </MatExpansionPanelSubHeader>
        </MatExpansionPanelSummary>
        <MatExpansionPanelDetails>
            <MatAccordion Multi="true">
                @foreach (Lokaal lokaal in lokalen)
                {
                    <MatExpansionPanel>
                        <MatExpansionPanelSummary>
                            <MatExpansionPanelHeader>Lokaal @lokaal.lokaalNr</MatExpansionPanelHeader>
                        </MatExpansionPanelSummary>
                        <MatExpansionPanelDetails>
                            <MatList>
                                <MatListItem>
                                    Banken
                                    <p style="text-align:right; width:100%; padding:0;"></p>
                                    <MatButton Label="-" style="padding-right:20px" OnClick="@lokaal.verwijderBank" />
                                    <p style="padding-right:10px; max-height:10px">@lokaal.aantalBanken</p>
                                    <MatButton Label="+" style="margin-right:20px;" OnClick="@lokaal.voegBankToe" />
                                    <MatIconButton Icon="notification_important" style="position: absolute; right: 0" OnClick="@voegToeAanDefect"></MatIconButton>
                                </MatListItem>
                                <MatListDivider></MatListDivider>
                                <MatListItem>
                                    Beamers
                                    <p style="text-align:right; width:100%; padding:0;"></p>
                                    <MatButton Label="-" style="padding-right:20px" OnClick="@lokaal.verwijderBeamer" />
                                    <p style="padding-right:10px; max-height:10px">@lokaal.aantalBeamers</p>
                                    <MatButton Label="+" style="margin-right:20px;" OnClick="@lokaal.voegBeamerToe" />
                                    <MatIconButton Icon="notification_important" style="position: absolute; right: 0" OnClick="@voegToeAanDefect"></MatIconButton>
                                </MatListItem>
                                <MatListDivider></MatListDivider>
                                <MatListItem>
                                    Stoelen
                                    <p style="text-align:right; width:100%; padding:0;"></p>
                                    <MatButton Label="-" style="padding-right:20px" OnClick="@lokaal.verwijderStoel" />
                                    <p style="padding-right:10px; max-height:10px">@lokaal.aantalStoelen</p>
                                    <MatButton Label="+" style="margin-right:20px;" OnClick="@lokaal.voegStoelToe" />
                                    <MatIconButton Icon="notification_important" style="position: absolute; right: 0" OnClick="@voegToeAanDefect"></MatIconButton>
                                </MatListItem>
                                <MatListDivider></MatListDivider>
                                <MatListItem>
                                    Computers
                                    <p style="text-align:right; width:100%; padding:0;"></p>
                                    <MatButton Label="-" style="padding-right:20px" OnClick="@lokaal.verwijderComputer" />
                                    <p style="padding-right:10px; max-height:10px">@lokaal.aantalComputers</p>
                                    <MatButton Label="+" style="margin-right:20px;" OnClick="@lokaal.voegComputerToe" />
                                    <MatIconButton Icon="notification_important" style="position: absolute; right: 0" OnClick="@voegToeAanDefect"></MatIconButton>
                                </MatListItem>
                                <MatListDivider></MatListDivider>
                                <MatListItem>
                                    Schermen
                                    <p style="text-align:right; width:100%; padding:0;"></p>
                                    <MatButton Label="-" style="padding-right:20px" OnClick="@lokaal.verwijderScherm" />
                                    <p style="padding-right:10px; max-height:10px">@lokaal.aantalSchermen</p>
                                    <MatButton Label="+" style="margin-right:20px;" OnClick="@lokaal.voegSchermToe" />
                                    <MatIconButton Icon="notification_important" style="position: absolute; right: 0" OnClick="@voegToeAanDefect"></MatIconButton>
                                </MatListItem>
                                <MatListItem>
                                    <MatButton Label="Verwijder Lokaal" style="position: absolute; right: 0;" OnClick="@verwijderLokaalPopUp" />
                                </MatListItem>
                            </MatList>
                        </MatExpansionPanelDetails>
                    </MatExpansionPanel>
                }
            </MatAccordion>
        </MatExpansionPanelDetails>
    </MatExpansionPanel>
</MatAccordion>

<MatButton Label="Voeg lokaal toe" OnClick="@maakWinkelTest" />


@DBConnection.ErrorMessage

@code {

    public DBConnection DBConnection { get; set; } = new DBConnection();
    public Lokaal lokaal { get; set; } = new Lokaal();

    public bool dialogIsOpen = false;
    public bool comfirmatieVerwijderLokaal = false;

    public Lokaal lokaal214 { get; set; }
    public Lokaal lokaal215 { get; set; }
    public Lokaal lokaal216 { get; set; }

    public List<WinkelDomain.Winkel> winkels = new List<WinkelDomain.Winkel>();
    public List<Lokaal> lokalen { get; set; }

    public void annuleerVerwijderLokaal()
    {
        comfirmatieVerwijderLokaal = false;
    }

    public void verwijderLokaalPopUp()
    {
        comfirmatieVerwijderLokaal = true;
    }

    protected override void OnInitialized()
    {
        winkels = DBConnection.GetAllWinkels();
        //TODO pull uit databank
        lokaal214 = new Lokaal();
        lokaal214.lokaalNr = 214;

        lokaal215 = new Lokaal();
        lokaal215.lokaalNr = 215;

        lokaal216 = new Lokaal();
        lokaal216.lokaalNr = 216;

        lokalen = new List<Lokaal>();
        lokalen.Add(lokaal214);
        lokalen.Add(lokaal215);
        lokalen.Add(lokaal216);

    }

    public void voegToeAanDefect()
    {
        dialogIsOpen = true;
    }

    public void popupOnClick()
    {
        //TODO voeg defect toe
    }

    public void verwijderLokaal()
    {
        //TODO verwijder lokaal uit databank


        comfirmatieVerwijderLokaal = false;
    }

    public void maakLokaalAan()
    {
        //TODO maak lokaal aan in databank
    }

    public void VerwijderWinkel(WinkelDomain.Winkel winkel)
    {
        //TODO VERANDER STATUS WINKEL
        this.StateHasChanged();
    }

    public void maakWinkelTest()
    {
        WinkelDomain.Winkel winkel = new WinkelDomain.Winkel();
        winkel.actief = true;
        winkel.beheerder = "LOL";
        winkel.naam = "DIT IS EEN TEST";
        DBConnection.AddWinkel(winkel);
        winkels.Add(winkel);
    }

}